<% layout("/layouts/boilerplate.ejs") %>
<body>
    <div class="row justify-content-center">
    <div class="col-12 col-lg-8">
    <h2>Edit your listing</h2>
    <form method="POST" action="/listings/<%= thisListing.id %>?_method=PATCH" novalidate class="needs-validation">
        <div class="mb-3">
            <label class="form-label">Title</label>
            <input type="text" value="<%= thisListing.title %>" name="listing[title]" required autocomplete="off" class="form-control">
        </div>
        <div class="mb-3">
            <label class="form-label">Description</label>
            <textarea name="listing[description]" rows="5" cols="30" required class="form-control"><%= thisListing.description %></textarea>
        </div>
        <div class="mb-3">
            <label class="form-label">Image url</label>
            <input type="text" value="<%= thisListing.image %>" name="listing[image]" required autocomplete="off" class="form-control">
        </div>
        <div class="mb-3">
            <label class="form-label">Price</label>
            <input type="number" min="0" value="<%= thisListing.price %>" name="listing[price]" required autocomplete="off" class="form-control">
        </div>
        <div class="mb-3">
            <label class="form-label">Location</label>
            <input type="text" value="<%= thisListing.location %>" name="listing[location]" required autocomplete="off" class="form-control">
        </div>
        <div class="mb-3">
            <label class="form-label">Country</label>
            <input type="text" value="<%= thisListing.country %>" name="listing[country]" required autocomplete="off" class="form-control">
        </div>
        <%
        let freeAmenities = [], premAmenities = [];
        for(idv of amenities){ 
            if(idv.premium === 0){
                freeAmenities.push(idv.amenity);
            } else {
                premAmenities.push(idv.amenity);
            }
        }
        const freeAmStr = freeAmenities.join(', ');
        const premAmStr = premAmenities.join(', ');
        %>
        <div class="mb-3">
            <label class="form-label">Free amenities</label>
            <input type="text" value="<%= freeAmStr %>" name="amenities[free]" required autocomplete="off" class="form-control" placeholder="add amenities separated by commas">
        </div>
        <div class="mb-3">
            <label class="form-label">Premium amenities</label>
            <input type="text" value="<%= premAmStr %>" name="amenities[premium]" required autocomplete="off" class="form-control" placeholder="add amenities separated by commas">
        </div>
        <button class="btn btn-dark">Update</button>
    </form>
    </div>
    </div>
</body>
